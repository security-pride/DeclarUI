import 'package:flutter/material.dart';

class NewsScreen extends StatefulWidget {
  @override
  _NewsScreenState createState() => _NewsScreenState();
}

class _NewsScreenState extends State<NewsScreen> with SingleTickerProviderStateMixin {
  late TabController _tabController;

  @override
  void initState() {
    super.initState();
    _tabController = TabController(length: 3, vsync: this);
  }

  @override
  void dispose() {
    _tabController.dispose();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('夸克日报'),
        actions: [
          IconButton(
            icon: Icon(Icons.search),
            onPressed: () {},
          ),
          IconButton(
            icon: Icon(Icons.share),
            onPressed: () {},
          ),
          IconButton(
            icon: Icon(Icons.close),
            onPressed: () {
              Navigator.pushNamed(context, 'Home');
            },
          ),
        ],
      ),
      body: Column(
        children: [
          _buildDateWeatherCard(),
          _buildNewsHeadline(),
          _buildTabBar(),
          Expanded(
            child: TabBarView(
              controller: _tabController,
              children: [
                _buildHotSearchList(),
                Center(child: Text('微博内容')),
                Center(child: Text('知乎内容')),
              ],
            ),
          ),
          _buildBottomCards(),
        ],
      ),
    );
  }

  Widget _buildDateWeatherCard() {
    return Container(
      padding: EdgeInsets.all(16),
      color: Colors.blue,
      child: Row(
        children: [
          Text(
            '07\n16',
            style: TextStyle(fontSize: 32, color: Colors.white),
          ),
          SizedBox(width: 16),
          Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              Text('早报', style: TextStyle(fontSize: 24, color: Colors.white)),
              Text('武汉市 30°C', style: TextStyle(color: Colors.white)),
            ],
          ),
        ],
      ),
    );
  }

  Widget _buildNewsHeadline() {
    return Container(
      padding: EdgeInsets.all(16),
      child: Column(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
          Text('余承东回应常接任王非批:有误解', style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold)),
          Text('如何扭转地方财政收缩态势?专家建议', style: TextStyle(fontSize: 16)),
          Text('美特勤局局长:调整特朗普贴身警卫', style: TextStyle(fontSize: 16)),
        ],
      ),
    );
  }

  Widget _buildTabBar() {
    return TabBar(
      controller: _tabController,
      tabs: [
        Tab(text: '热搜'),
        Tab(text: '微博'),
        Tab(text: '知乎'),
      ],
    );
  }

  Widget _buildHotSearchList() {
    return ListView(
      children: [
        _buildHotSearchItem('1', '400多件裤子退货店家损失近80...', '170w'),
        _buildHotSearchItem('2', '几千块手机为何离不开几块钱的...', '109w'),
        _buildHotSearchItem('3', '全面深化改革的实践续篇', '89w'),
        _buildHotSearchItem('4', '抓娃娃票房', '87w'),
        _buildHotSearchItem('5', '小天愿意跟相柳走不是因为誓言', '45w'),
      ],
    );
  }

  Widget _buildHotSearchItem(String rank, String title, String views) {
    return ListTile(
      leading: Text(rank, style: TextStyle(color: Colors.blue, fontWeight: FontWeight.bold)),
      title: Text(title),
      trailing: Text(views, style: TextStyle(color: Colors.grey)),
    );
  }

  Widget _buildBottomCards() {
    return Row(
      children: [
        Expanded(
          child: Card(
            child: ListTile(
              leading: Icon(Icons.eco, color: Colors.green),
              title: Text('芭芭农场'),
              subtitle: Text('新鲜水果包邮到家'),
              trailing: TextButton(
                child: Text('去施肥'),
                onPressed: () {},
              ),
            ),
          ),
        ),
        Expanded(
          child: Card(
            child: ListTile(
              leading: Icon(Icons.card_giftcard, color: Colors.red),
              title: Text('福利中心'),
              subtitle: Text('现金红包天天领取'),
              trailing: TextButton(
                child: Text('去领钱'),
                onPressed: () {},
              ),
            ),
          ),
        ),
      ],
    );
  }
}