import 'package:flutter/material.dart';

class ScannerScreen extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('夸克扫描王'),
        actions: [
          IconButton(
            icon: Icon(Icons.refresh),
            onPressed: () {},
          ),
          IconButton(
            icon: Icon(Icons.close),
            onPressed: () {
              Navigator.pushNamed(context, 'Home');
            },
          ),
        ],
      ),
      body: SingleChildScrollView(
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            _buildLoginSection(),
            _buildFeaturesGrid(),
            _buildImportSection(),
            _buildRecentUsageSection(),
          ],
        ),
      ),
      floatingActionButton: FloatingActionButton(
        child: Icon(Icons.camera_alt),
        onPressed: () {},
      ),
      bottomNavigationBar: _buildBottomNavigationBar(context),
    );
  }

  Widget _buildLoginSection() {
    return Padding(
      padding: const EdgeInsets.all(16.0),
      child: Row(
        mainAxisAlignment: MainAxisAlignment.spaceBetween,
        children: [
          Row(
            children: [
              CircleAvatar(
                child: Icon(Icons.person),
                backgroundColor: Colors.grey,
              ),
              SizedBox(width: 8),
              Text('登录查看扫描件'),
            ],
          ),
          ElevatedButton(
            child: Text('立即登录'),
            onPressed: () {},
          ),
        ],
      ),
    );
  }

  Widget _buildFeaturesGrid() {
    List<Map<String, dynamic>> features = [
      {'icon': Icons.document_scanner, 'label': '万能扫描'},
      {'icon': Icons.text_fields, 'label': '提取文字'},
      {'icon': Icons.insert_drive_file, 'label': '转Word'},
      {'icon': Icons.translate, 'label': '拍照翻译'},
      {'icon': Icons.table_chart, 'label': '提取表格'},
      {'icon': Icons.badge, 'label': '拍证件照'},
      {'icon': Icons.credit_card, 'label': '扫描证件'},
      {'icon': Icons.color_lens, 'label': '寸照换底色'},
      {'icon': Icons.event_note, 'label': '会议记录'},
      {'icon': Icons.g_translate, 'label': '取词翻译'},
      {'icon': Icons.edit, 'label': '去手写'},
      {'icon': Icons.high_quality, 'label': '文档变高清'},
      {'icon': Icons.picture_as_pdf, 'label': '图片转PDF'},
      {'icon': Icons.table_chart, 'label': '图片转Excel'},
      {'icon': Icons.text_fields, 'label': '图片转TXT'},
      {'icon': Icons.screen_record, 'label': '记录屏幕'},
    ];

    return GridView.builder(
      shrinkWrap: true,
      physics: NeverScrollableScrollPhysics(),
      gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(
        crossAxisCount: 4,
        childAspectRatio: 1,
      ),
      itemCount: features.length,
      itemBuilder: (context, index) {
        return Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            Icon(features[index]['icon'], color: Colors.blue),
            SizedBox(height: 4),
            Text(features[index]['label'], textAlign: TextAlign.center),
          ],
        );
      },
    );
  }

  Widget _buildImportSection() {
    return Column(
      crossAxisAlignment: CrossAxisAlignment.start,
      children: [
        Padding(
          padding: const EdgeInsets.all(16.0),
          child: Text('选择导入方式，快速发起扫描'),
        ),
        Row(
          mainAxisAlignment: MainAxisAlignment.spaceEvenly,
          children: [
            OutlinedButton.icon(
              icon: Icon(Icons.insert_drive_file),
              label: Text('文档导入'),
              onPressed: () {},
            ),
            OutlinedButton.icon(
              icon: Icon(Icons.photo_library),
              label: Text('相册导入'),
              onPressed: () {},
            ),
            OutlinedButton.icon(
              icon: Icon(Icons.wechat),
              label: Text('微信导入'),
              onPressed: () {},
            ),
          ],
        ),
      ],
    );
  }

  Widget _buildRecentUsageSection() {
    return Column(
      crossAxisAlignment: CrossAxisAlignment.start,
      children: [
        Padding(
          padding: const EdgeInsets.all(16.0),
          child: Text('最近使用', style: TextStyle(fontWeight: FontWeight.bold)),
        ),
        ListTile(
          leading: Stack(
            children: [
              Image.asset('assets/images/template.png', width: 48, height: 48),
              Positioned(
                right: 0,
                bottom: 0,
                child: Container(
                  padding: EdgeInsets.all(2),
                  decoration: BoxDecoration(
                    color: Colors.blue,
                    shape: BoxShape.circle,
                  ),
                  child: Text('8', style: TextStyle(color: Colors.white, fontSize: 10)),
                ),
              ),
            ],
          ),
          title: Text('夸克扫描王操作手册'),
          subtitle: Text('2024-07-16 11:30 • 8MB'),
        ),
      ],
    );
  }

  Widget _buildBottomNavigationBar(BuildContext context) {
    return BottomNavigationBar(
      type: BottomNavigationBarType.fixed,
      items: [
        BottomNavigationBarItem(icon: Icon(Icons.home), label: '首页'),
        BottomNavigationBarItem(icon: Icon(Icons.folder), label: '文件管理'),
        BottomNavigationBarItem(icon: Icon(Icons.camera_alt), label: ''),
        BottomNavigationBarItem(icon: Icon(Icons.build), label: '全部工具'),
        BottomNavigationBarItem(icon: Icon(Icons.person), label: '扫描会员'),
      ],
      onTap: (index) {
        if (index == 0) {
          Navigator.pushNamed(context, 'Home');
        }
      },
    );
  }
}